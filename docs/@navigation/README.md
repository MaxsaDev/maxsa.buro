# Навігація та меню

Документація по системі навігації та меню додатку.

## Документи

- [Система меню](./menu-system.md) — повна документація по гнучкій системі меню: типи, структура БД, Views, адміністрування
- [Відображення меню в сайдбарі](./user-admin-menu.md) — архітектура сайдбару: компоненти, Zustand store, потік даних

## Ключові принципи

### Три типи меню

| Тип          | Таблиця словника           | Таблиця призначень  | Прив'язка до офісу |
| ------------ | -------------------------- | ------------------- | ------------------ |
| **sections** | `menu_user_sections_items` | `nav_user_sections` | Так                |
| **items**    | `menu_user_items`          | `nav_user_items`    | Так                |
| **general**  | `menu_general_items`       | `nav_user_general`  | Ні — завжди видно  |

### is_default — «загальнодоступний пункт»

`is_default = true` означає, що пункт меню видно **без явного призначення**:

- **sections / items** — видно у **всіх офісах** користувача (не потребує запису в `nav_user_sections`/`nav_user_items`)
- **general** — видно **всім користувачам** без прив'язки до офісу

Реалізується на рівні SQL View (`EXISTS(...) OR is_default = TRUE`), тригери не використовуються.

### Оновлення сайдбару

Сайдбар будується Server-side через `buildUserMenu(userId)`. Оновлення відбувається автоматично через `revalidatePath('/(protected)', 'layout')` після:

- будь-якої зміни призначень меню
- зміни активного офісу в `OfficeSwitcher`
