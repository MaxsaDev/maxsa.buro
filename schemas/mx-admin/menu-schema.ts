import { z } from 'zod';

/**
 * Схема валідації для назви пункту меню
 *
 * Правила:
 * - Мінімум 1 символ, максимум 200
 * - Дозволені українські та латинські літери, цифри, пробіли, дефіси, підкреслення
 * - Не може бути тільки пробілами
 */
export const menuTitleSchema = z
  .string()
  .min(1, { message: 'Назва не може бути порожньою' })
  .max(200, { message: 'Назва не може бути довшою за 200 символів' })
  .refine(
    (val) => {
      // Перевірка що не тільки пробіли
      return val.trim().length >= 1;
    },
    { message: 'Назва не може складатися тільки з пробілів' }
  );

/**
 * Схема валідації для URL пункту меню
 *
 * Правила:
 * - Може бути порожнім (для внутрішніх маршрутів)
 * - Якщо не порожнє, має бути валідним URL або шляхом (починається з /)
 */
export const menuUrlSchema = z.string().refine(
  (val) => {
    // Дозволяємо порожній рядок
    if (val.trim() === '') {
      return true;
    }
    // Перевірка чи це валідний URL
    try {
      // Якщо починається з /, це внутрішній шлях - дозволяємо
      if (val.startsWith('/')) {
        return true;
      }
      // Якщо це повний URL
      new URL(val);
      return true;
    } catch {
      return false;
    }
  },
  {
    message: 'Некоректний URL. Має бути повний URL (https://...) або шлях (починається з /)',
  }
);

/**
 * Схема валідації для іконки пункту меню
 *
 * Правила:
 * - Мінімум 1 символ, максимум 50
 * - Тільки латинські літери та цифри
 * - Не може бути порожнім
 */
export const menuIconSchema = z
  .string()
  .min(1, { message: 'Назва іконки не може бути порожньою' })
  .max(50, { message: 'Назва іконки не може бути довшою за 50 символів' })
  .regex(/^[A-Za-z0-9]+$/, {
    message: 'Назва іконки може містити тільки латинські літери та цифри',
  });
